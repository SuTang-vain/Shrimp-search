# 🧠 本地智能助手开发计划 v2.0

> 基于用户提供的开发计划与项目结构参考图，对项目进行详细规划与分解。

## 🎯 总体目标

构建一个智能、本地化的个人助理，具备文档管理、信息整合、任务通知与IDE监管功能，基于增强型交互式多模态RAG系统。

## 🧩 项目结构与模块划分

参考用户提供的项目结构图，将项目划分为以下主要模块，以实现模块化开发和高内聚低耦合。

```
Interactive_Multi_RAG/
├── core/
│   ├── main.py                     # 主程序入口
│   ├── config.py                   # 环境变量与模型配置
│   ├── utils.py                    # 通用工具函数
├── agents/
│   ├── base_agent.py               # Agent基类
│   ├── rag_agent.py                # 核心RAG Agent
│   ├── web_agent.py                # 网络搜索Agent
│   ├── task_agent.py               # 任务管理Agent
│   ├── multimodal_agent.py         # 多模态处理Agent
│   ├── ide_agent.py                # IDE监管Agent
├── data/
│   ├── document_processor.py       # 文档预处理、分块、嵌入
│   ├── vector_db.py                # Qdrant向量数据库接口
│   ├── knowledge_base.py           # 知识库管理与RAG流程
├── interfaces/
│   ├── user_interface.py           # Streamlit用户界面
│   ├── notifications.py            # 桌面通知系统
├── models/
│   ├── local_model.py              # Qwen2.5本地模型接口
│   ├── cloud_model.py              # GLM4.5/OpenAI云端模型接口
├── tests/                          # 单元测试与集成测试
└── requirements.txt                # 项目依赖
```

## 🚀 分阶段开发计划

### ✅ 第一阶段：本地文件管理与核心RAG系统构建

**目标**：完成本地文件的自动处理、Qdrant数据库的搭建、Qwen2.5模型的本地部署，并初始化一个可用的RAG Agent。

#### 任务列表

1. **环境配置**：
   - [ ] 编写`requirements.txt`文件，包含所有依赖库。
   - [ ] 创建`config.py`，管理所有环境变量和模型参数。
   - [ ] 编写`utils.py`，实现日志记录、路径管理等通用功能。
2. **本地模型与数据库部署**：
   - [ ] 使用Ollama或Transformers部署Qwen2.5-7B，并创建`models/local_model.py`封装API调用。
   - [ ] 编写`data/vector_db.py`，实现Qdrant数据库的连接、索引创建和向量插入功能。
3. **文件监听与数据处理**：
   - [ ] 在`data/document_processor.py`中实现文件系统监听模块（如使用`watchdog`库），监控指定目录。
   - [ ] 实现文件格式识别、内容提取、分块和`intfloat/e5-large-v2`嵌入生成。
   - [ ] 将生成好的向量同步到Qdrant数据库。
4. **RAG Agent初始化**：
   - [ ] 创建`agents/base_agent.py`作为所有Agent的基类。
   - [ ] 编写`agents/rag_agent.py`，实现基础的检索增强生成逻辑：`query` -> `retrieve_from_qdrant` -> `rerank` -> `generate_with_local_model`。
5. **桌面提醒系统**：
   - [ ] 在`interfaces/notifications.py`中，使用`win10toast`或`plyer`实现简单的桌面通知功能。

### 📄 第二阶段：文档处理与多模态能力扩展

**目标**：让助理具备对文档进行摘要、翻译、整合的能力，并初步支持多模态（图像）输入。

#### 任务列表

1. **文档处理功能增强**：
   - [ ] 扩展`data/document_processor.py`，支持PDF, DOCX, TXT, Markdown等多种文档格式。
   - [ ] 在`agents/rag_agent.py`中集成文档摘要和翻译功能，可智能选择调用本地或云端模型。
   - [ ] 编写`data/knowledge_base.py`，实现跨文档的信息整合与问答功能。
2. **多模态处理模块**：
   - [ ] 创建`agents/multimodal_agent.py`，实现OCR（如使用`pytesseract`）和图像分析功能。
   - [ ] 将多模态Agent与RAG Agent集成，实现图像和文本的混合查询。
3. **用户界面原型**：
   - [ ] 在`interfaces/user_interface.py`中，使用Streamlit构建一个基础的用户界面，包含文件上传、文本输入、结果显示等功能。

### 🧠 第三阶段：任务管理与系统稳定性提升

**目标**：引入任务管理机制，提升系统运行的稳定性和效率，并集成网络搜索功能。

#### 任务列表

1. **任务管理系统**：
   - [ ] 编写`agents/task_agent.py`，实现一个基于线程池的异步任务队列管理器，用于处理耗时操作（如批量文档处理）。
   - [ ] 将桌面通知功能与任务管理Agent集成，实现任务完成后的自动提醒。
2. **CAMEL稳定性改进**：
   - [ ] 改进`agents/base_agent.py`，添加健壮的错误处理和重试机制。
   - [ ] 在`agents`模块中实现智能降级策略：`CAMEL` -> `OpenAI API` -> `Local Model`。
   - [ ] 在`models/cloud_model.py`中实现OpenAI和GLM4.5的API调用封装。
3. **网络搜索功能**：
   - [ ] 创建`agents/web_agent.py`，集成多搜索引擎（Google, Bing, DuckDuckGo）的API，实现异步并发搜索。
   - [ ] 实现智能内容过滤和结果去重功能，并根据相关性进行评分和排序。

### 🧪 第四阶段：IDE监管与系统全面集成

**目标**：实现IDE插件的监管功能，完成所有模块的集成，并进行全面的性能优化和测试。

#### 任务列表

1. **IDE监管模块**：
   - [ ] 创建`agents/ide_agent.py`，深入研究VSCode/PyCharm等IDE的插件API或运行时进程，探查可行性。
   - [ ] 编写代码实现运行时进程监听、状态检测（如根据log文件）和任务完成后的通知推送。
2. **全面集成与优化**：
   - [ ] 将所有Agent（RAG, Web, Task, Multimodal, IDE）与`core/main.py`中的主程序逻辑进行整合。
   - [ ] 在`interfaces/user_interface.py`中完善Streamlit界面，添加实时状态显示、交互式图表等。
   - [ ] 进行性能测试和压力测试，对RAG算法、模型调用、任务队列等进行性能调优。
   - [ ] 编写详细的安装指南和用户文档，确保项目易于部署和使用。